# -*- coding: utf-8 -*-
"""abydos.phones

The phones module implements ...


Copyright 2014 by Christopher C. Little.
This file is part of Abydos.

Abydos is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

Abydos is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with Abydos. If not, see <http://www.gnu.org/licenses/>.
"""

from __future__ import unicode_literals
from ._compat import _unicode, _range
import unicodedata


PHONETIC_FEATURES = {'t': 0b10011010100000000001011010000000000010000010101010101010101010,
                     't͇': 0b10011010100000000001011010000000000010000010101010101010101010,
                     't̪': 0b10011010100000000001010110000000000010000010101010101010101010,
                     't̠': 0b10011010100000000001100110000000000010000010101010101010101010,
                     'd': 0b10011010100000000001011010000000000010000001101010101010101010,
                     'd͇': 0b10011010100000000001011010000000000010000001101010101010101010,
                     'd̪': 0b10011010100000000001010110000000000010000001101010101010101010,
                     'd̠': 0b10011010100000000001100110000000000010000001101010101010101010,
                     's': 0b10011010100000000001011010000000000010000010101010100110011010,
                     's͇': 0b10011010100000000001011010000000000010000010101010100110011010,
                     's̪': 0b10011010100000000001010110000000000010000010101010100110011010,
                     's̟': 0b10011010100000000001010110000000000010000010101010100110011010,
                     'z': 0b10011010100000000001011010000000000010000001101010100110011010,
                     'z͇': 0b10011010100000000001011010000000000010000001101010100110011010,
                     'z̪': 0b10011010100000000001010110000000000010000001101010100110011010,
                     'z̟': 0b10011010100000000001010110000000000010000001101010100110011010,
                     'θ̱': 0b10011010100000000001011010000000000010000010101010100110101010,
                     'θ͇': 0b10011010100000000001011010000000000010000010101010100110101010,
                     'ɹ̝̊': 0b10011010100000000001011010000000000010000010101010100110101010,
                     'ð̠': 0b10011010100000000001011010000000000010000001101010100110101010,
                     'ð͇': 0b10011010100000000001011010000000000010000001101010100110101010,
                     'ɹ̝': 0b10011010100000000001011010000000000010000001101010100110101010,
                     'ɬ': 0b10011010100000000001011010000000000010000010011010100110100110,
                     'ɮ': 0b10011010100000000001011010000000000010000001101010100110100110,
                     'θ': 0b10011010100000000001010110000000000010000010101010100110101010,
                     's̄': 0b10011010100000000001010110000000000010000010101010100110011010,
                     'ð': 0b10011010100000000001010110000000000010000001101010100110101010,
                     'ð̞': 0b10010101100000000001010110000000000010000001101010100110101010,
                     'ʃ': 0b10011010100000000001100101101010101010000010101010100110011010,
                     'ʃʲ': 0b10011010100000000001100101101010101010000010101010100110011010,
                     'š': 0b10011010100000000001100101101010101010000010101010100110011010,
                     'ɹ̠̊˔': 0b10011010100000000001100110000000000010000010101010100110101010,
                     'ʒ': 0b10011010100000000001100101101010101010000001101010100110011010,
                     'ʒʲ': 0b10011010100000000001100101101010101010000001101010100110011010,
                     'ž': 0b10011010100000000001100101101010101010000001101010100110011010,
                     'ɹ̠˔': 0b10011010100000000001100110000000000010000001101010100110101010,
                     'c': 0b10011010100000000010000001011010101010000010101010101010101010,
                     'ɟ': 0b10011010100000000010000001011010101010000001101010101010101010,
                     'ç': 0b10011010100000000010000001011010101010000010101010100110101010,
                     'ʝ': 0b10011010100000000010000001011010101010000001101010100110101010,
                     'p': 0b10011010011010101010000010000000000010000010101010101010101010,
                     'p̪': 0b10011010011010100110000010000000000010000010101010101010101010,
                     'p͆': 0b10011010011010100110000010000000000010000010101010101010101010,
                     'b': 0b10011010011010101010000010000000000010000001101010101010101010,
                     'b̪': 0b10011010011010100110000010000000000010000001101010101010101010,
                     'b͆': 0b10011010011010100110000010000000000010000001101010101010101010,
                     'f': 0b10011010011010100110000010000000000010000010101010100110101010,
                     'v': 0b10011010011010100110000010000000000010000001101010100110101010,
                     'ɸ': 0b10011010011010101010000010000000000010000010101010100110101010,
                     'ɸ̞': 0b10010101011010101010000010000000000010000010101010100110101010,
                     'β': 0b10011010011010101010000010000000000010000001101010100110101010,
                     'β̞': 0b10010101011010101010000010000000000010000001101010100110101010,
                     'k': 0b10011010100000000010000001011010011010000010101010101010101010,
                     'ɡ': 0b10011010100000000010000001011010011010000001101010101010101010,
                     'g': 0b10011010100000000010000001011010011010000001101010101010101010,
                     'x': 0b10011010100000000010000001011010011010000010101010100110101010,
                     'x̞': 0b10100101100000000010000001011010011010000010101010100110101010,
                     'ɣ': 0b10011010100000000010000001011010011010000001101010100110101010,
                     'ɰ': 0b10100101100000000010000001011010011010000001101010100110101010,
                     'ɣ̞': 0b10100101100000000010000001011010011010000001101010100110101010,
                     'ɣ˕': 0b10100101100000000010000001011010011010000001101010100110101010,
                     'q': 0b10011010100000000010000001101010011010000010101010101010101010,
                     'ɢ': 0b10011010100000000010000001101010011010000001101010101010101010,
                     'χ': 0b10011010100000000010000001101010011010000010101010100110101010,
                     'x̣': 0b10011010100000000010000001101010011010000010101010100110101010,
                     'χ̞': 0b10010101100000000010000001101010011010000010101010100110101010,
                     'ʁ': 0b10011010100000000010000001101010011010000001101010100110101010,
                     'ʁ̝': 0b10011010100000000010000001101010011010000001101010100110101010,
                     'ʁ̞': 0b10010101100000000010000001101010011010000001101010100110101010,
                     'ħ': 0b10011010100000000010000010000000000001100110101010100110101010,
                     'ħ̞': 0b10010101100000000010000010000000000001100110101010100110101010,
                     'ʕ': 0b10011010100000000010000010000000000001100101101010100110101010,
                     'ʕ̝': 0b10011010100000000010000010000000000001100101101010100110101010,
                     'ʕ̞': 0b10010101100000000010000010000000000001100101101010100110101010,
                     'ɑ̯': 0b10010101100000000010000010000000000001100101101010100110101010,
                     'h': 0b10011010100000000010000010000000000010000010011010100110101010,
                     'h̃': 0b10010101100000000010000010000000000010000010011010100101101010,
                     'ɦ': 0b10011010100000000010000010000000000010000001011010100110101010,
                     'ʔ': 0b10011010100000000010000010000000000010000010100110101010101010,
                     'm': 0b10010110011010101010000010000000000010000001101010101001101010,
                     'm̥': 0b10010110011010101010000010000000000010000010101010101001101010,
                     'ɱ': 0b10010110011010100110000010000000000010000001101010101001101010,
                     'm̪': 0b10010110011010100110000010000000000010000001101010101001101010,
                     'n': 0b10010110100000000001011010000000000010000001101010101001101010,
                     'n̪': 0b10010110100000000001010110000000000010000001101010101001101010,
                     'n̥': 0b10010110100000000001011010000000000010000010101010101001101010,
                     'n̊': 0b10010110100000000001011010000000000010000010101010101001101010,
                     'n̪̊': 0b10010110100000000001010110000000000010000010101010101001101010,
                     'ɳ': 0b10010110100000000001101010000000000010000001101010101001101010,
                     'ɳ̊': 0b10010110100000000001101010000000000010000010101010101001101010,
                     'ɳ̥': 0b10010110100000000001101010000000000010000010101010101001101010,
                     'ɲ': 0b10010110100000000010000001011010101010000001101010101001101010,
                     'ñ': 0b10010110100000000010000001011010101010000001101010101001101010,
                     'n̠ʲ': 0b10010110100000000001100101011010101010000001101010101001101010,
                     'ɲ̟': 0b10010110100000000001100101011010101010000001101010101001101010,
                     'ɲ̊': 0b10010110100000000010000001011010101010000010101010101001101010,
                     'ɲ̥': 0b10010110100000000010000001011010101010000010101010101001101010,
                     'ŋ': 0b10010110100000000010000001011010011010000001101010101001101010,
                     'ŋ̊': 0b10010110100000000010000001011010011010000010101010101001101010,
                     'ɴ': 0b10010110100000000010000001101010011010000001101010101001101010,
                     'l': 0b10010101100000000001011010000000000010000001101010100110100110,
                     'l̠': 0b10010101100000000001100110000000000010000001101010100110100110,
                     'l̪': 0b10010101100000000001010110000000000010000001101010100110100110,
                     'ɫ': 0b10010101100000000001011001011010011010000001101010100110100110,
                     'lˠ': 0b10010101100000000001011001011010011010000001101010100110100110,
                     'lˤ': 0b10010101100000000001011001011010011010000001101010100110100110,
                     'l̴': 0b10010101100000000001011001011010011010000001101010100110100110,
                     'ɫ̪': 0b10010101100000000001010101011010011010000001101010100110100110,
                     'l̪ˠ': 0b10010101100000000001010101011010011010000001101010100110100110,
                     'l̪ˤ': 0b10010101100000000001010101011010011010000001101010100110100110,
                     'l̴̪': 0b10010101100000000001010101011010011010000001101010100110100110,
                     'l̥': 0b10010101100000000001011010000000000010000010101010100110100110,
                     'ʎ': 0b10010101100000000010000001011010101010000001101010100110100110,
                     'l̠ʲ': 0b10010101100000000001100101011010101010000001101010100110100110,
                     'ʎ̟': 0b10010101100000000001100101011010101010000001101010100110100110,
                     'ʟ': 0b10010101100000000010000001011010011010000001101010100110100110,
                     'r': 0b10010110100000000001011010000000000010000001101010101010101010,
                     'r̥': 0b10010110100000000001011010000000000010000010101010101010101010,
                     'ɹ': 0b10010101100000000001011010000000000010000001101010100110101010,
                     'ð̠˕': 0b10010101100000000001011010000000000010000001101010100110101010,
                     'ʀ': 0b10010110100000000010000001101010011010000001101010101010101010,
                     'ʀ̥': 0b10010110100000000010000001101010011010000010101010101010101010,
                     'j': 0b10100101100000000010000001011010101010000001101010100110101010,
                     'i̯': 0b10100101100000000010000001011010101010000001101010100110101010,
                     'j̊': 0b10100101100000000010000001011010101010000010101010100110101010,
                     'w': 0b10100101010110101010000001011010011010000001101010100110101010,
                     'u̯': 0b10100101010110101010000001011010011010000001101010100110101010,
                     'ɰʷ': 0b10100101010110101010000001011010011010000001101010100110101010,
                     'ʍ': 0b10100101010110101010000001011010011010000010101010100110101010,
                     'w̥': 0b10100101010110101010000001011010011010000010101010100110101010,
                     'ɰᵝ': 0b10100101010110011010000001011010011010000001101010100110101010,
                     'wᵝ': 0b10100101010110011010000001011010011010000001101010100110101010,
                     'ɥ': 0b10100101010110101010000001011010101010000001101010100110101010,
                     'jʷ': 0b10100101010110101010000001011010101010000001101010100110101010,
                     'ʡ': 0b10011010100000000010000010000000000001101010101010101010101010,
                     'ʜ': 0b10011010100000000010000010000000000001101010101010100110101010,
                     'ʢ': 0b10011010100000000010000010000000000001101001101010100110101010,
                     'ʢ̝': 0b10011010100000000010000010000000000001101001101010100110101010,
                     'ʢ̞': 0b10010101100000000010000010000000000001101001101010100110101010,
                     'ᴙ': 0b10010110100000000010000010000000000001101001101010101010101010,
                     'ʙ': 0b10010110011010101010000010000000000010000001101010101010101010,
                     'ʋ': 0b10010101011010100110000010000000000010000001101010100110101010,
                     'ɕ': 0b10011010100000000001100101011010101010000010101010100110011010,
                     'ʑ': 0b10011010100000000001100101011010101010000001101010100110011010,
                     'ɾ': 0b10010110100000000001011010000000000010000001101010100110101010,
                     'ᴅ': 0b10010110100000000001011010000000000010000001101010100110101010,
                     'ɾ̥': 0b10010110100000000001011010000000000010000010101010100110101010,
                     'ɾ̊': 0b10010110100000000001011010000000000010000010101010100110101010,
                     'ᴅ̥': 0b10010110100000000001011010000000000010000010101010100110101010,
                     'ᴅ̊': 0b10010110100000000001011010000000000010000010101010100110101010,
                     'ɾ̃': 0b10010110100000000001011010000000000010000001101010100101101010,
                     'n̆': 0b10010110100000000001011010000000000010000001101010100101101010,
                     'ⱱ': 0b10010110011010100110000010000000000010000001101010100110101010,
                     'ⱱ̟': 0b10010110011010101010000010000000000010000001101010100110101010,
                     'w̆': 0b10010110011010101010000010000000000010000001101010100110101010,
                     'b̆': 0b10010110011010101010000010000000000010000001101010100110101010,
                     'ɢ̆': 0b10010110100000000010000001101010011010000001101010100110101010,
                     'ʀ̆': 0b10010110100000000010000001101010011010000001101010100110101010,
                     'ʡ̯': 0b10010110100000000010000010000000000001101001101010100110101010,
                     'ɺ': 0b10010110100000000001011010000000000010000001101010100110100110,
                     'ʎ̯': 0b10010110100000000010000001011010101010000001101010100110100110,
                     'ʟ̆': 0b10010110100000000010000001011010011010000001101010100110100110,
                     'ʈ': 0b10011010100000000001101010000000000010000010101010101010101010,
                     'ɖ': 0b10011010100000000001101010000000000010000001101010101010101010,
                     'ʂ': 0b10011010100000000001101010000000000010000010101010100110011010,
                     'ʐ': 0b10011010100000000001101010000000000010000001101010100110011010,
                     'ɻ': 0b10010101100000000001101010000000000010000001101010100110101010,
                     'ɽ': 0b10010110100000000001101010000000000010000001101010100110101010,
                     'ɽ͡r': 0b10010110100000000001101010000000000010000001101010101010101010,
                     'ɭ': 0b10010101100000000001101010000000000010000001101010100110100110,
                     'ɭ̆': 0b10010110100000000001101010000000000010000001101010100110100110,
                     'ɺ˞': 0b10010110100000000001101010000000000010000001101010100110100110,
                     'ɺ̢': 0b10010110100000000001101010000000000010000001101010100110100110,
                     'ꞎ': 0b10011010100000000001101010000000000010000010011010100110100110,
                     'ʎ̝̊': 0b10011010100000000010000001011010101010000010101010100110100110,
                     'ʟ̝̊': 0b10011010100000000010000001011010011010000010101010100110100110,
                     'ʟ̝': 0b10011010100000000010000001011010011010000001101010100110100110,
                     # affricates & co-articulated
                     't͡ʃ': 0b10011010100000000001100101101010101010000010101010101110011001,
                     'ʧ': 0b10011010100000000001100101101010101010000010101010101110011001,
                     't͜ʃ': 0b10011010100000000001100101101010101010000010101010101110011001,
                     't̠ʲʃ': 0b10011010100000000001100101101010101010000010101010101110011001,
                     'č': 0b10011010100000000001100101101010101010000010101010101110011001,
                     'd͡ʒ': 0b10011010100000000001100101101010101010000001101010101110011001,
                     'ʤ': 0b10011010100000000001100101101010101010000001101010101110011001,
                     'd͜ʒ': 0b10011010100000000001100101101010101010000001101010101110011001,
                     'd̠ʲʒ': 0b10011010100000000001100101101010101010000001101010101110011001,
                     'ǯ': 0b10011010100000000001100101101010101010000001101010101110011001,
                     't͡s': 0b10011010100000000001011010000000000010000010101010101110011001,
                     'ʦ': 0b10011010100000000001011010000000000010000010101010101110011001,
                     't͜s': 0b10011010100000000001011010000000000010000010101010101110011001,
                     't̪͡s̪': 0b10011010100000000001010110000000000010000010101010101110011001,
                     't͡s̪': 0b10011010100000000001010110000000000010000010101010101110011001,
                     't̟͡s̟': 0b10011010100000000001010110000000000010000010101010101110011001,
                     't͡s̟': 0b10011010100000000001010110000000000010000010101010101110011001,
                     'ʦ̪': 0b10011010100000000001010110000000000010000010101010101110011001,
                     'ʦ̟': 0b10011010100000000001010110000000000010000010101010101110011001,
                     't͡θ̠': 0b10011010100000000001011010000000000010000010101010101110101001,
                     't͡θ͇': 0b10011010100000000001011010000000000010000010101010101110101001,
                     't͡θ': 0b10011010100000000001010110000000000010000010101010101110101001,
                     't͜θ': 0b10011010100000000001010110000000000010000010101010101110101001,
                     't̪͡θ': 0b10011010100000000001010110000000000010000010101010101110101001,
                     't̟͡θ': 0b10011010100000000001010110000000000010000010101010101110101001,
                     'd͡z': 0b10011010100000000001011010000000000010000001101010101110011001,
                     'ʣ': 0b10011010100000000001011010000000000010000001101010101110011001,
                     'd͜z': 0b10011010100000000001011010000000000010000001101010101110011001,
                     'd̪͡z̪': 0b10011010100000000001010110000000000010000001101010101110011001,
                     'd͡z̪': 0b10011010100000000001010110000000000010000001101010101110011001,
                     'd̟͡z̟': 0b10011010100000000001010110000000000010000001101010101110011001,
                     'd͡z̟': 0b10011010100000000001010110000000000010000001101010101110011001,
                     'ʣ̪': 0b10011010100000000001010110000000000010000001101010101110011001,
                     'ʣ̟': 0b10011010100000000001010110000000000010000001101010101110011001,
                     'd͡ð̠': 0b10011010100000000001011010000000000010000001101010101110101001,
                     'd͡ð̳': 0b10011010100000000001011010000000000010000001101010101110101001,
                     'd͡ð': 0b10011010100000000001010110000000000010000001101010101110101001,
                     'd͜ð': 0b10011010100000000001010110000000000010000001101010101110101001,
                     'd̪͡ð': 0b10011010100000000001010110000000000010000001101010101110101001,
                     'd̟͡ð': 0b10011010100000000001010110000000000010000001101010101110101001,
                     'k͡x': 0b10011010100000000010000001011010011010000010101010101110101001,
                     'ɡ͡ɣ': 0b10011010100000000010000001011010011010000001101010101110101001,
                     'g͡ɣ': 0b10011010100000000010000001011010011010000001101010101110101001,
                     'p͡f': 0b10011010011010101110000010000000000010000010101010101110101001,
                     'p̪͡f': 0b10011010011010100110000010000000000010000010101010101110101001,
                     'b͡v': 0b10011010011010101110000010000000000010000001101010101110101001,
                     'b̪͡v': 0b10011010011010100110000010000000000010000001101010101110101001,
                     'b̪͜v': 0b10011010011010100110000010000000000010000001101010101110101001,
                     't͡ɕ': 0b10011010100000000001100101011010101010000010101010101110011001,
                     't͜ɕ': 0b10011010100000000001100101011010101010000010101010101110011001,
                     'ʨ': 0b10011010100000000001100101011010101010000010101010101110011001,
                     'd͡ʑ': 0b10011010100000000001100101011010101010000001101010101110011001,
                     'd͜ʑ': 0b10011010100000000001100101011010101010000001101010101110011001,
                     'ʥ': 0b10011010100000000001100101011010101010000001101010101110011001,
                     'ʈ͡ʂ': 0b10011010100000000001101010000000000010000010101010101110011001,
                     't͡ʂ': 0b10011010100000000001101010000000000010000010101010101110011001,
                     'ɖ͡ʐ': 0b10011010100000000001101010000000000010000001101010101110011001,
                     'd͡ʐ': 0b10011010100000000001101010000000000010000001101010101110011001,
                     't͡ɬ': 0b10011010100000000001011010000000000010000010011010101110100101,
                     't͜ɬ': 0b10011010100000000001011010000000000010000010011010101110100101,
                     'ƛ': 0b10011010100000000001011010000000000010000010011010101110100101,
                     'd͡ɮ': 0b10011010100000000001011010000000000010000001101010101110100101,
                     'c͡ç': 0b10011010100000000010000001011010101010000010101010101110101001,
                     'c͜ç': 0b10011010100000000010000001011010101010000010101010101110101001,
                     'ɟ͡ʝ': 0b10011010100000000010000001011010101010000001101010101110101001,
                     'c͡ʎ̝̥': 0b10011010100000000010000001011010101010000010101010101110100101,
                     'k͡ʟ̝̊': 0b10011010100000000010000001011010011010000010101010101110100101,
                     'ɡ͡ʟ̝': 0b10011010100000000010000001011010011010000001101010101110100101,
                     'q͡χ': 0b10011010100000000010000001101010011010000010101010101110101001,
                     'ɢ͡ʁ': 0b10011010100000000010000001101010011010000001101010101110101001,
                     'ɢ͜ʁ': 0b10011010100000000010000001101010011010000001101010101110101001,
                     'ɧ': 0b10011010100000000001101001011010011010000010101010100110011010,
                     'k͡p': 0b10011010011010101010000001011010011010000010101010101010101010,
                     'k͜p': 0b10011010011010101010000001011010011010000010101010101010101010,
                     'ɡ͡b': 0b10011010011010101010000001011010011010000001101010101010101010,
                     'kʷ': 0b10011010010110101010000001011010011010000010101010101010101010,
                     'k͡w': 0b10011010010110101010000001011010011010000010101010101010101010,
                     'k͜w': 0b10011010010110101010000001011010011010000010101010101010101010,
                     'kʷh': 0b10011010010110101010000001011010011010000010011010101010101010,
                     'gʷ': 0b10011010010110101010000001011010011010000001101010101010101010,
                     'g͡w': 0b10011010010110101010000001011010011010000001101010101010101010,
                     'gʷh': 0b10011010010110101010000001011010011010000001011010101010101010,
                     # implosives
                     'ɓ̥': 0b10011010011010101010000010000000000010000010100101101010101010,
                     'ƥ': 0b10011010011010101010000010000000000010000010100101101010101010,
                     'pʼ↓': 0b10011010011010101010000010000000000010000010100101101010101010,
                     'ɓ': 0b10011010011010101010000010000000000010000001100101101010101010,
                     'ɗ̥': 0b10011010100000000001011010000000000010000010100101101010101010,
                     'ƭ': 0b10011010100000000001011010000000000010000010100101101010101010,
                     'tʼ↓': 0b10011010100000000001011010000000000010000010100101101010101010,
                     'ɗ': 0b10011010100000000001011010000000000010000001100101101010101010,
                     'ᶑ': 0b10011010100000000001101010000000000010000001100101101010101010,
                     'ʄ̊': 0b10011010100000000010000001011010101010000010100101101010101010,
                     'ƈ': 0b10011010100000000010000001011010101010000010100101101010101010,
                     'cʼ↓': 0b10011010100000000010000001011010101010000010100101101010101010,
                     'ʄ': 0b10011010100000000010000001011010101010000001100101101010101010,
                     'ɠ': 0b10011010100000000010000001011010011010000001100101101010101010,
                     'ʛ': 0b10011010100000000010000001101010011010000001100101101010101010,
                     # clicks
                     'ʘ': 0b10011010011010101010000010000000000010000010101010011010101010,
                     'ʘʰ': 0b10011010011010101010000010000000000010000010011010011010101010,
                     'ʘ̬': 0b10011010011010101010000010000000000010000001101010011010101010,
                     'ᶢʘ': 0b10011010011010101010000010000000000010000001101010011010101010,
                     'ʘ̃': 0b10011010011010101010000010000000000010000001101010011001101010,
                     'ᵑʘ': 0b10011010011010101010000010000000000010000001101010011001101010,
                     'ᵐʘ': 0b10011010011010101010000010000000000010000001101010011001101010,
                     'ʘ̥̃ʰ': 0b10011010011010101010000010000000000010000010011010011001101010,
                     'ᵑ̊ʘʰ': 0b10011010011010101010000010000000000010000010011010011001101010,
                     'ʘ̃ˀ': 0b10011010011010101010000010000000000010000010100110011001101010,
                     'ᵑʘˀ': 0b10011010011010101010000010000000000010000010100110011001101010,
                     'ʘ̃͜ʔ': 0b10011010011010101010000010000000000010000010100110011001101010,
                     'ᵑ̊ʘˀ': 0b10011010011010101010000010000000000010000010100110011001101010,
                     'ǀ': 0b10011010100000000001010110000000000010000010101010011010101010,
                     'ʇ': 0b10011010100000000001010110000000000010000010101010011010101010,
                     'ǀ̬': 0b10011010100000000001010110000000000010000001101010011010101010,
                     'ʇ̬': 0b10011010100000000001010110000000000010000001101010011010101010,
                     'ᶢǀ': 0b10011010100000000001010110000000000010000001101010011010101010,
                     'ᶢʇ': 0b10011010100000000001010110000000000010000001101010011010101010,
                     'ǀ̃': 0b10011010100000000001010110000000000010000001101010011001101010,
                     'ʇ̃': 0b10011010100000000001010110000000000010000001101010011001101010,
                     'ᵑǀ': 0b10011010100000000001010110000000000010000001101010011001101010,
                     'ⁿǀ': 0b10011010100000000001010110000000000010000001101010011001101010,
                     'ᵑʇ': 0b10011010100000000001010110000000000010000001101010011001101010,
                     'ǀ̥̃ʰ': 0b10011010100000000001010110000000000010000010011010011001101010,
                     'ʇ̥̃ʰ': 0b10011010100000000001010110000000000010000010011010011001101010,
                     'ᵑ̊ǀʰ': 0b10011010100000000001010110000000000010000010011010011001101010,
                     'ᵑ̊ʇʰ': 0b10011010100000000001010110000000000010000010011010011001101010,
                     'ǀ̃ˀ': 0b10011010100000000001010110000000000010000010100110011001101010,
                     'ʇ̃ˀ': 0b10011010100000000001010110000000000010000010100110011001101010,
                     'ᵑǀˀ': 0b10011010100000000001010110000000000010000010100110011001101010,
                     'ᵑʇˀ': 0b10011010100000000001010110000000000010000010100110011001101010,
                     'ᵑ̊ǀˀ': 0b10011010100000000001010110000000000010000010100110011001101010,
                     'ᵑ̊ʇˀ': 0b10011010100000000001010110000000000010000010100110011001101010,
                     'ǃ': 0b10011010100000000001011010000000000010000010101010011010101010,
                     'ʗ': 0b10011010100000000001011010000000000010000010101010011010101010,
                     'ǃʰ': 0b10011010100000000001011010000000000010000010011010011010101010,
                     'ʗʰ': 0b10011010100000000001011010000000000010000010011010011010101010,
                     'ǃ̬': 0b10011010100000000001011010000000000010000001101010011010101010,
                     'ʗ̬': 0b10011010100000000001011010000000000010000001101010011010101010,
                     'ᶢǃ': 0b10011010100000000001011010000000000010000001101010011010101010,
                     'ᶢʗ': 0b10011010100000000001011010000000000010000001101010011010101010,
                     'ǃ̃': 0b10011010100000000001011010000000000010000001101010011001101010,
                     'ᵑǃ': 0b10011010100000000001011010000000000010000001101010011001101010,
                     'ʗ̃': 0b10011010100000000001011010000000000010000001101010011001101010,
                     'ᵑʗ': 0b10011010100000000001011010000000000010000001101010011001101010,
                     'ǃ̥̃ʰ': 0b10011010100000000001011010000000000010000010011010011001101010,
                     'ʗ̃̊ʰ': 0b10011010100000000001011010000000000010000010011010011001101010,
                     'ᵑ̊ǃʰ': 0b10011010100000000001011010000000000010000010011010011001101010,
                     'ᵑ̊ʗʰ': 0b10011010100000000001011010000000000010000010011010011001101010,
                     'ǃ̃ˀ': 0b10011010100000000001011010000000000010000010100110011001101010,
                     'ʗ̃ˀ': 0b10011010100000000001011010000000000010000010100110011001101010,
                     'ᵑǃˀ': 0b10011010100000000001011010000000000010000010100110011001101010,
                     'ᵑʗˀ': 0b10011010100000000001011010000000000010000010100110011001101010,
                     'ǂ': 0b10011010100000000010000001011010101010000010101010011010101010,
                     'ʄ̵': 0b10011010100000000010000001011010101010000010101010011010101010,
                     '⨎': 0b10011010100000000010000001011010101010000010101010011010101010,
                     'ǂʰ': 0b10011010100000000010000001011010101010000010011010011010101010,
                     'ǂ̬': 0b10011010100000000010000001011010101010000001101010011010101010,
                     'ᶢǂ': 0b10011010100000000010000001011010101010000001101010011010101010,
                     'ǂ̃': 0b10011010100000000010000001011010101010000001101010011001101010,
                     'ᵑǂ': 0b10011010100000000010000001011010101010000001101010011001101010,
                     'ǂ̥̃ʰ': 0b10011010100000000010000001011010101010000010011010011001101010,
                     'ᵑ̊ǂʰ': 0b10011010100000000010000001011010101010000010011010011001101010,
                     'ǂ̃ˀ': 0b10011010100000000010000001011010101010000010100110011001101010,
                     'ᵑǂˀ': 0b10011010100000000010000001011010101010000010100110011001101010,
                     'ᵑǂ͡ʔ': 0b10011010100000000010000001011010101010000010100110011001101010,
                     'ᵑ̊ǂˀ': 0b10011010100000000010000001011010101010000010100110011001101010,
                     'ǃ͡s': 0b10011010100000000010000001011010101010000010101010011010011010,
                     'ǂᶴ': 0b10011010100000000010000001011010101010000010101010011010011010,
                     'ǁ': 0b10011010100000000001011010000000000010000010101010011010100110,
                     'ʖ': 0b10011010100000000001011010000000000010000010101010011010100110,
                     'ǁʰ': 0b10011010100000000001011010000000000010000010011010011010100110,
                     'ʖʰ': 0b10011010100000000001011010000000000010000010011010011010100110,
                     'ǁ̬': 0b10011010100000000001011010000000000010000001101010011010100110,
                     'ʖ̬': 0b10011010100000000001011010000000000010000001101010011010100110,
                     'ᶢǁ': 0b10011010100000000001011010000000000010000001101010011010100110,
                     'ᶢʖ': 0b10011010100000000001011010000000000010000001101010011010100110,
                     'ǁ̃': 0b10011010100000000001011010000000000010000001101010011001100110,
                     'ʖ̃': 0b10011010100000000001011010000000000010000001101010011001100110,
                     'ᵑǁ': 0b10011010100000000001011010000000000010000001101010011001100110,
                     'ᵑʖ': 0b10011010100000000001011010000000000010000001101010011001100110,
                     'ǁ̥̃ʰ': 0b10011010100000000001011010000000000010000010011010011001100110,
                     'ʖ̥̃ʰ': 0b10011010100000000001011010000000000010000010011010011001100110,
                     'ᵑ̊ǁʰ': 0b10011010100000000001011010000000000010000010011010011001100110,
                     'ᵑ̊ʖʰ': 0b10011010100000000001011010000000000010000010011010011001100110,
                     'ǁ̃ˀ': 0b10011010100000000001011010000000000010000010100110011001100110,
                     'ʖ̃ˀ': 0b10011010100000000001011010000000000010000010100110011001100110,
                     'ᵑǁˀ': 0b10011010100000000001011010000000000010000010100110011001100110,
                     'ᵑʖˀ': 0b10011010100000000001011010000000000010000010100110011001100110,
                     'ᵑǁ͡ʔ': 0b10011010100000000001011010000000000010000010100110011001100110,
                     'ʖ̃͜ʔ': 0b10011010100000000001011010000000000010000010100110011001100110,
                     'ǃ˞': 0b10011010100000000001101010000000000010000010101010011010101010,
                     'ǃǁ': 0b10011010100000000001101010000000000010000010101010011010101010,
                     '‼': 0b10011010100000000001101010000000000010000010101010011010101010,
                     '!!': 0b10011010100000000001101010000000000010000010101010011010101010,
                     'ǃ˞ʰ': 0b10011010100000000001101010000000000010000010011010011010101010,
                     '‼ʰ': 0b10011010100000000001101010000000000010000010011010011010101010,
                     '!!ʰ': 0b10011010100000000001101010000000000010000010011010011010101010,
                     'ǃ̬˞': 0b10011010100000000001101010000000000010000001101010011010101010,
                     'ᶢǃ˞': 0b10011010100000000001101010000000000010000001101010011010101010,
                     '‼̬': 0b10011010100000000001101010000000000010000001101010011010101010,
                     '!!̬': 0b10011010100000000001101010000000000010000001101010011010101010,
                     'ᶢ‼': 0b10011010100000000001101010000000000010000001101010011010101010,
                     'ᶢ!!': 0b10011010100000000001101010000000000010000001101010011010101010,
                     'ǃ̃˞': 0b10011010100000000001101010000000000010000001101010011001101010,
                     'ᵑǃ˞': 0b10011010100000000001101010000000000010000001101010011001101010,
                     '‼̃': 0b10011010100000000001101010000000000010000001101010011001101010,
                     '!!̃': 0b10011010100000000001101010000000000010000001101010011001101010,
                     'ᵑ‼': 0b10011010100000000001101010000000000010000001101010011001101010,
                     'ᵑ!!': 0b10011010100000000001101010000000000010000001101010011001101010,
                     'ǃ̥̃˞ʰ': 0b10011010100000000001101010000000000010000010011010011001101010,
                     'ᵑ̊ǃ˞ʰ': 0b10011010100000000001101010000000000010000010011010011001101010,
                     '‼̥̃ʰ': 0b10011010100000000001101010000000000010000010011010011001101010,
                     '!!̥̃ʰ': 0b10011010100000000001101010000000000010000010011010011001101010,
                     'ᵑ̊‼ʰ': 0b10011010100000000001101010000000000010000010011010011001101010,
                     'ᵑ̊!!ʰ': 0b10011010100000000001101010000000000010000010011010011001101010,
                     'ǃ̃˞ˀ': 0b10011010100000000001101010000000000010000010100110011001101010,
                     'ᵑǃ˞͜ʔ': 0b10011010100000000001101010000000000010000010100110011001101010,
                     'ᵑ̊‼ˀ': 0b10011010100000000001101010000000000010000010100110011001101010,
                     'ᵑ‼ˀ': 0b10011010100000000001101010000000000010000010100110011001101010,
                     '‼̃ˀ': 0b10011010100000000001101010000000000010000010100110011001101010,
                     'ᵑ̊!!ˀ': 0b10011010100000000001101010000000000010000010100110011001101010,
                     'ᵑ!!ˀ': 0b10011010100000000001101010000000000010000010100110011001101010,
                     '!!̃ˀ': 0b10011010100000000001101010000000000010000010100110011001101010,
                     
                     # vowels
                     'i': 0b01100101011010101010000001011001100101011001101010100110101010,
                     'ɪ': 0b01100101011010101010000001011001101001101001101010100110101010,
                     'ɩ': 0b01100101011010101010000001011001101001101001101010100110101010,
                     'u': 0b01100101010110101010000001011010010101011001101010100110101010,
                     'ʊ': 0b01100101010110101010000001011010011001101001101010100110101010,
                     'ɷ': 0b01100101010110101010000001011010011001101001101010100110101010,
                     'ᴜ': 0b01100101010110101010000001011010011001101001101010100110101010,
                     'ɯ̽': 0b01100101011010101010000001011010011001101001101010100110101010,
                     'ʊ̜': 0b01110101011010101010000001011010011001101001101010100110101010,
                     'e': 0b01100101011010101010000001101001100101011001101010100110101010,
                     'ɛ': 0b01100101011010101010000001101001101001101001101010100110101010,
                     'o': 0b01100101010110101010000001101010010101011001101010100110101010,
                     'ɤ': 0b01100101011010101010000001101010010101011001101010100110101010,
                     'ɔ': 0b01100101010110101010000001101010011001101001101010100110101010,
                     'ʌ': 0b01100101011010101010000001101010011001101001101010100110101010,
                     'a': 0b01100101011010101010000001100101101001101001101010100110101010,
                     'a̟': 0b01100101011010101010000001100101101001101001101010100110101010,
                     'æ̞': 0b01100101011010101010000001100101101001101001101010100110101010,
                     'ɶ': 0b01100101010110101010000001100101101001101001101010100110101010,
                     'æ': 0b01100101011010101010000001100101100101101001101010100110101010,
                     'y': 0b01100101010110101010000001011001100101011001101010100110101010,
                     'ʏ': 0b01100101010110101010000001011001101001101001101010100110101010,
                     'ø': 0b01100101010110101010000001101001100101011001101010100110101010,
                     'œ': 0b01100101010110101010000001101001101001101001101010100110101010,
                     'ə': 0b01100101011110101010000001101010100101101001101010100110101010,
                     'ɵ̞': 0b01100101010110101010000001101010100101101001101010100110101010,
                     'ə̹': 0b01100101010110101010000001101010100101101001101010100110101010,
                     'ɞ̝': 0b01100101010110101010000001101010100101101001101010100110101010,
                     'ɘ̞': 0b01100101011010101010000001101010100101101001101010100110101010,
                     'ɯ': 0b01100101011010101010000001011010010101101001101010100110101010,
                     'ɒ': 0b01100101010110101010000001100110011001101001101010100110101010,
                     'ɑ': 0b01100101011010101010000001100110011001101001101010100110101010,
                     'ɨ': 0b01100101011010101010000001011010100101011001101010100110101010,
                     'ï': 0b01100101011010101010000001011010100101011001101010100110101010,
                     'ʉ': 0b01100101010110101010000001011010100101011001101010100110101010,
                     'ü': 0b01100101010110101010000001011010100101011001101010100110101010,
                     'ɘ': 0b01100101011010101010000001101010100101011001101010100110101010,
                     'ë': 0b01100101011010101010000001101010100101011001101010100110101010,
                     'ɵ': 0b01100101010110101010000001101010100101011001101010100110101010,
                     'ö': 0b01100101010110101010000001101010100101011001101010100110101010,
                     'ɜ': 0b01100101011010101010000001101010101001011001101010100110101010,
                     'ɛ̈': 0b01100101011010101010000001101010101001011001101010100110101010,
                     'ɞ': 0b01100101010110101010000001101010101001011001101010100110101010,
                     'ɔ̈': 0b01100101010110101010000001101010101001011001101010100110101010,
                     'ä': 0b01100101011010101010000001100110101001101001101010100110101010,
                     'a̠': 0b01100101011010101010000001100110101001101001101010100110101010,
                     'ɑ̈': 0b01100101011010101010000001100110101001101001101010100110101010,
                     'ɐ̞': 0b01100101011010101010000001100110101001101001101010100110101010,
                     'ɐ': 0b01100101011110101010000001100110100101101001101010100110101010,
                     'ɜ̞': 0b01100101011010101010000001100110100101101001101010100110101010,
                     'ɞ̞': 0b01100101010110101010000001100110100101101001101010100110101010,
                     'ɪ̟': 0b01100101011010101010000001011001101001011001101010100110101010,
                     'ʏ̟': 0b01100101010110101010000001011001101001011001101010100110101010,
                     'ʏ̫': 0b01100101010101101010000001011001101001101001101010100110101010,
                     'ʏʷ': 0b01100101010101101010000001011001101001101001101010100110101010,
                     'ɪʷ': 0b01100101010101101010000001011001101001101001101010100110101010,
                     'y̫': 0b01100101010101101010000001011001100101011001101010100110101010,
                     'yʷ': 0b01100101010101101010000001011001100101011001101010100110101010,
                     'iʷ': 0b01100101010101101010000001011001100101011001101010100110101010,
                     'u͍': 0b01100101010110011010000001011010010101011001101010100110101010,
                     'ɯᵝ': 0b01100101010110011010000001011010010101011001101010100110101010,
                     'ɯ͡β̞': 0b01100101010110011010000001011010010101011001101010100110101010,
                     'ʉ͍': 0b01100101010110011010000001011010100101011001101010100110101010,
                     'ɨᵝ': 0b01100101010110011010000001011010100101011001101010100110101010,
                     'ɨ͡β̞': 0b01100101010110011010000001011010100101011001101010100110101010,
                     'ɪ̈': 0b01100101011010101010000001011010101001011001101010100110101010,
                     'ɨ̞': 0b01100101011010101010000001011010101001011001101010100110101010,
                     'ɘ̝': 0b01100101011010101010000001011010101001011001101010100110101010,
                     'ʊ̈': 0b01100101010110101010000001011010101001011001101010100110101010,
                     'ʉ̞': 0b01100101010110101010000001011010101001011001101010100110101010,
                     'ø̫': 0b01100101010101101010000001101001100101011001101010100110101010,
                     'øʷ': 0b01100101010101101010000001101001100101011001101010100110101010,
                     'eʷ': 0b01100101010101101010000001101001100101011001101010100110101010,
                     'e̞': 0b01100101011010101010000001101001100101101001101010100110101010,
                     'ɛ̝': 0b01100101011010101010000001101001100101101001101010100110101010,
                     'ø̞': 0b01100101010110101010000001101001100101101001101010100110101010,
                     'œ̝': 0b01100101010110101010000001101001100101101001101010100110101010,
                     'o̞': 0b01100101010110101010000001101010010101101001101010100110101010,
                     'ɔ̝': 0b01100101010110101010000001101010010101101001101010100110101010,
                     'ɤ̞': 0b01100101011010101010000001101010010101101001101010100110101010,
                     'ʌ̝': 0b01100101011010101010000001101010010101101001101010100110101010,

                     # feature diacritics
                     'ʰ': 0b00000000000000000000000000000000000000000000010000000000000000,
                     'ʱ': 0b00000000000000000000000000000000000000000001010000000000000000,
                     '̤': 0b00000000000000000000000000000000000000000001010000000000000000,
                     'ʼ': 0b00000000000000000000000000000000000000000000000100000000000000,
                     '̚': 0b00000000000000000000000000000000000000000000100000000000000000,
                     '̬': 0b00000000000000000000000000000000000000000001000000000000000000,
                     '̌': 0b00000000000000000000000000000000000000000001000000000000000000,
                     '̥': 0b00000000000000000000000000000000000000000010000000000000000000,
                     '̊': 0b00000000000000000000000000000000000000000010000000000000000000,
                     'ʷ': 0b00000000010111111100000000000000000000000000000000000000000000,
                     'ʲ': 0b00000000000000000000000001011111111100000000000000000000000000,
                     '̰': 0b00000000000000000000000000000000000000000001000100000000000000,
                     '̩': 0b01000000000000000000000000000000000000000000000000000000000000,
                     '̯': 0b10000000000000000000000000000000000000000000000000000000000000,
                     '̃': 0b00000000000000000000000000000000000000000000000000000001000000,
                     '̨': 0b00000000000000000000000000000000000000000000000000000001000000,
                     '͊': 0b00000000000000000000000000000000000000000000000000000010000000,
                     'ˠ': 0b00000000000000000000000001011011011100000000000000000000000000,
                     '̴': 0b00000000000000000000000001011011011100000000000000000000000000,
                     'ˤ': 0b00000000000000000000000000000000000001111100000000000000000000,
                     '̘': 0b00000000000000000000000000000000000001011000000000000000000000,
                     '̙': 0b00000000000000000000000000000000000001100100000000000000000000,
                     '˭': 0b00000000000000000000000000000000000000000010101000000010000000,
                     }

FEATURE_MASK = {
                'syllabic': 0b11000000000000000000000000000000000000000000000000000000000000,
                'consonantal': 0b00110000000000000000000000000000000000000000000000000000000000,
                'sonorant': 0b00001100000000000000000000000000000000000000000000000000000000,
                'approximant': 0b00000011000000000000000000000000000000000000000000000000000000,
                'labial': 0b00000000110000000000000000000000000000000000000000000000000000,
                'round': 0b00000000001100000000000000000000000000000000000000000000000000,
                'protruded': 0b00000000000011000000000000000000000000000000000000000000000000,
                'compressed': 0b00000000000000110000000000000000000000000000000000000000000000,
                'labiodental': 0b00000000000000001100000000000000000000000000000000000000000000,
                'coronal': 0b00000000000000000011000000000000000000000000000000000000000000,
                'anterior': 0b00000000000000000000110000000000000000000000000000000000000000,
                'distributed': 0b00000000000000000000001100000000000000000000000000000000000000,
                'dorsal': 0b00000000000000000000000011000000000000000000000000000000000000,
                'high': 0b00000000000000000000000000110000000000000000000000000000000000,
                'low': 0b00000000000000000000000000001100000000000000000000000000000000,
                'front': 0b00000000000000000000000000000011000000000000000000000000000000,
                'back': 0b00000000000000000000000000000000110000000000000000000000000000,
                'tense': 0b00000000000000000000000000000000001100000000000000000000000000,
                'pharyngeal': 0b00000000000000000000000000000000000011000000000000000000000000,
                'atr': 0b00000000000000000000000000000000000000110000000000000000000000,
                'rtr': 0b00000000000000000000000000000000000000001100000000000000000000,
                'voice': 0b00000000000000000000000000000000000000000011000000000000000000,
                'spread_glottis': 0b00000000000000000000000000000000000000000000110000000000000000,
                'constricted_glottis': 0b00000000000000000000000000000000000000000000001100000000000000,
                'glottalic_suction': 0b00000000000000000000000000000000000000000000000011000000000000,
                'velaric_suction': 0b00000000000000000000000000000000000000000000000000110000000000,
                'continuant': 0b00000000000000000000000000000000000000000000000000001100000000,
                'nasal': 0b00000000000000000000000000000000000000000000000000000011000000,
                'strident': 0b00000000000000000000000000000000000000000000000000000000110000,
                'lateral': 0b00000000000000000000000000000000000000000000000000000000001100,
                'delayed_release': 0b00000000000000000000000000000000000000000000000000000000000011,
               }

def ipa_to_features(ipa):
    """Return the feature representation (as a list of ints) of one or more
    phones

    Arguments:
    ipa -- the IPA representation of a phone or series of phones
    """
    features = []
    pos = 0
    ipa = unicodedata.normalize('NFC', _unicode(ipa.lower()))

    maxsymlen = max([len(_) for _ in PHONETIC_FEATURES.keys()])

    while pos < len(ipa):
        found_match = False
        for i in _range(maxsymlen, 0, -1):
            if pos+i-1 <= len(ipa) and ipa[pos:pos+i] in PHONETIC_FEATURES:
                features.append(PHONETIC_FEATURES[ipa[pos:pos+i]])
                pos += i
                found_match = True

        if not found_match:
            features.append(-1)
            pos += 1

    return features


def get_feature(vector, feature):
    """Returns a list of ints representing presents/absence/neutrality with
    respect to a particular phonetic feature

    Arguments:
    vector -- a tuple or list of ints representing the phonetic features of a
        phone (such as is returned by the ipa_to_features function
    feature -- a feature name from the set:
        'consonantal', 'sonorant', 'syllabic', 'labial', 'round', 'coronal',
        'anterior', 'distributed', 'dorsal', 'high', 'low', 'back', 'tense',
        'pharyngeal', 'ATR', 'voice', 'spread_glottis', 'constricted_glottis',
        'continuant', 'strident', 'lateral', 'delayed_release', 'nasal'
    #binary -- if False, -1, 0, & 1 represent -, 0, & +
    #          if True, only binary oppositions are allowed:
    #          0 & 1 represent - & + and 0s are mapped to -
    """
    if feature not in FEATURE_MASK:
        raise AttributeError("feature must be one of: 'consonantal', \
'sonorant', 'syllabic', 'labial', 'round', 'coronal', 'anterior', \
'distributed', 'dorsal', 'high', 'low', 'back', 'tense', 'pharyngeal', 'ATR', \
'voice', 'spread_glottis', 'constricted_glottis', 'continuant', 'strident', \
'lateral', 'delayed_release', 'nasal'")

    # each feature mask contains two bits, one each for - and +
    mask = FEATURE_MASK[feature]
    # the lower bit represents +
    pos_mask = mask >> 1
    retvec = []
    for char in vector:
        if char < 0:
            retvec.append(float('NaN'))
        else:
            masked = char & mask
            if masked == 0:
                retvec.append(0) # 0
            elif masked == mask:
                retvec.append(2) # +/-
            elif masked & pos_mask:
                retvec.append(1) # +
            else:
                retvec.append(-1) # -

    return retvec
